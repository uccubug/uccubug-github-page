import{ab as b,ac as F,p as m,h as I,o as S,c as T,Y as x,Z as k,j as h,k as y,t as O,n as A,N as P,ae as G,q as U,G as C,F as z,C as E,ad as M,a as $}from"./chunks/framework.BOdwdXAg.js";import"./chunks/dayjs.min.C6AzRWTt.js";import"./chunks/theme.CewpmPjo.js";function j(){let r,i;return{promise:new Promise((e,s)=>{r=e,i=s}),resolve:r,reject:i}}function R(r,i=!0){const{promise:t,resolve:e,reject:s}=j(),o=new FileReader,a={};return o.readAsDataURL(r),o.onload=p=>{const d=p.target.result;if(a.url=d,!i){const f=new Image;f.src=d,a.element=f}e(a)},t}const X="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",W=["src"],V=["accept"],q={class:"fc-content"},Z={__name:"index",props:b(G({content:String,width:Number,height:Number,accept:String,imgMod:Boolean},{content:"选择文件",width:"100",height:"100",accept:"image/*",imgMod:!0}),{file:{default:null},fileModifiers:{}}),emits:b(["onChange"],["update:file"]),setup(r,{emit:i}){const t=F(r,"file"),e=m(""),s=i,o=I(()=>r.imgMod&&r.accept.startsWith("image/")),a=p=>{var f,v;const d=((v=(f=p==null?void 0:p.target)==null?void 0:f.files)==null?void 0:v[0])||null;t.value=d,o&&d&&R(d).then(w=>{e.value=w.url}),s("onChange",d)};return(p,d)=>(S(),T("div",{class:A(["fc-wrap",{withBg:o.value,hasBg:!!e.value}]),style:P({width:`${r.width}px`,height:`${r.height}px`})},[x(h("img",{src:e.value||y(X),class:"fc-img"},null,8,W),[[k,o.value]]),h("input",{class:"file-chooser",type:"file",accept:r.accept,onChange:a},null,40,V),h("div",q,O(r.content),1)],6))}},c={NINE_3x3:0,SIX_2x3:1,SIX_3x2:2,THREE_1x3:3,THREE_3x1:4},g={TOP_LEFT:0,LEFT:1,BOTTOM_LEFT:2,TOP:3,CENTER:4,BOTTOM:5,TOP_RIGHT:6,RIGHT:7,BOTTOM_RIGHT:8};class J{constructor(i,t){this.img=i,this.imgSize=(i==null?void 0:i.size)||{width:0,height:0},this.options={mode:c.NINE_3x3,minPad:0,align:g.CENTER,bg:"#fff",...t},this.cvsSize=void 0,this.perSize=void 0,i&&this.updateCvsAndPerSize()}splitToCvs(){const i=[],t=document.createElement("canvas");t.width=this.cvsSize.width,t.height=this.cvsSize.height;const e=t.getContext("2d",{willReadFrequently:!0});e.fillStyle=this.options.bg,e.fillRect(0,0,t.width,t.height);const[s,o]=this.getPaintIndex();e.drawImage(this.img,0,0,this.imgSize.width,this.imgSize.height,s,o,this.imgSize.width,this.imgSize.height);let a,p=0;const d=this.splitPartsIdxGenerator();for(a=d.next();!a.done;)i.push(this.genCvs(e.getImageData(...a.value),`${p}.jpg`)),p++,a=d.next();return i}updateParams(i=null,t=this.options){this.options={...this.options,...t},i&&(this.img=i,this.imgSize={widht:i.width,height:i.height}),this.updateCvsAndPerSize()}updateCvsAndPerSize(){const i=this.imgSize.width+this.options.minPad*2,t=this.imgSize.height+this.options.minPad*2;let e,s,o,a;this.perSize={},this.cvsSize={},this.options.mode===c.NINE_3x3?(e=Math.ceil(Math.max(i,t)/3)*3,s=e/3,o=e,a=e):this.options.mode===c.THREE_1x3?(i<=t*3?e=t*3:e=Math.ceil(i/3)*3,s=e/3,o=e,a=s):this.options.mode===c.THREE_3x1?(t<=i*3?e=i*3:e=Math.ceil(t/3)*3,s=e/3,o=s,a=e):this.options.mode===c.SIX_2x3?(i>t*3/2?(e=Math.ceil(i/3)*3,s=e/3):(s=Math.ceil(t/2),e=s*3),s=e/3,o=e,a=2*s):this.options.mode===c.SIX_3x2&&(t>i*3/2?(e=Math.ceil(t/3)*3,s=e/3):(s=Math.ceil(i/2),e=s*3),s=e/3,o=2*s,a=e),this.perSize={width:s,height:s},this.cvsSize={width:o,height:a}}getPaintIndex(){const i=this.imgSize.width+this.options.minPad*2,t=this.imgSize.height+this.options.minPad*2,e=this.cvsSize.width,s=this.cvsSize.height;let o=0,a=0;switch(this.options.align){case g.TOP_LEFT:break;case g.LEFT:a=(s-t)/2;break;case g.BOTTOM_LEFT:a=s-t;break;case g.TOP:o=(e-i)/2;break;case g.CENTER:o=(e-i)/2,a=(s-t)/2;break;case g.BOTTOM:o=(e-i)/2,a=s-t;break;case g.TOP_RIGHT:o=e-i;break;case g.RIGHT:o=e-i,a=(s-t)/2;break;case g.BOTTOM_RIGHT:o=e-i,a=s-t;break}return[o+this.options.minPad,a+this.options.minPad]}*splitPartsIdxGenerator(){for(let i=0;i<3;i++)if(this.options.mode===c.THREE_1x3)yield[i*this.perSize.width,0,this.perSize.width,this.perSize.height];else if(this.options.mode===c.THREE_3x1)yield[0,i*this.perSize.width,this.perSize.width,this.perSize.height];else if([c.SIX_2x3,c.SIX_3x2,c.NINE_3x3].includes(this.options.mode))for(let t=0;t<3;t++)if(this.options.mode===c.SIX_2x3){if(t===2)break;const e=i*2+t,s=e%3,o=Math.floor(e/3);yield[s*this.perSize.width,o*this.perSize.height,this.perSize.width,this.perSize.height]}else if(this.options.mode===c.SIX_3x2){if(t===2)break;yield[t*this.perSize.width,i*this.perSize.height,this.perSize.width,this.perSize.height]}else yield[t*this.perSize.width,i*this.perSize.height,this.perSize.width,this.perSize.height]}loadImageData(i,t){const e=document.createElement("canvas"),s=e.getContext("2d"),o=document.createElement("a");o.download=t,e.width=this.perSize.width,e.height=this.perSize.height,s.putImageData(i,0,0),o.href=e.toDataURL("image/jpeg"),o.click()}genCvs(i,t){const e=document.createElement("canvas"),s=e.getContext("2d");return e.width=this.perSize.width,e.height=this.perSize.height,e.title=t,s.putImageData(i,0,0),e.addEventListener("click",()=>{const o=document.createElement("a");o.download=t,o.href=e.toDataURL("image/jpeg"),o.click()}),e}}const Q={creater(r,i){const t=new J(r,i);return new Proxy(t,{set(e,s,o){return e[s]=o,s==="img"&&(e.imgSize={width:o.width,height:o.height}),e.updateCvsAndPerSize(),!0}})}},Y={class:"img-spliter-box"},K={class:"row1 box-row"},ee={class:"left-img-preview"},te={class:"dld-tip"},ie={class:"right-options"},se={class:"split-mod option"},oe={class:"mod-options"},ae=["title","onClick"],ne={class:"align-mod option"},le={class:"mod-options"},he=["onClick"],re={class:"option option-inline"},ce={class:"padding"},de={class:"color"},pe={__name:"index",setup(r){const i=m(),t=m(null),e=m(g.CENTER),s=m(c.NINE_3x3),o=m(3),a=m(3),p=m(null),d=m(0),f=m("#ffffff"),v=Q.creater(),w=m(!1),L=(u,n)=>{s.value=u,o.value=n},N=I(()=>{const u=[];for(const n in c){const l=n.split("_"),_=l[1].split("x"),D=parseInt(_[0])*parseInt(_[1]);u.push({title:l[1],value:c[n],total:D,key:n,cols:parseInt(_[1])})}return u}),B=I(()=>{const u=[],n={TOP_LEFT:"↖",TOP:"↑",TOP_RIGHT:"↗",LEFT:"←",CENTER:"·",RIGHT:"→",BOTTOM_LEFT:"↙",BOTTOM:"↓",BOTTOM_RIGHT:"↘"};for(const l in n)u.push({key:l,char:n[l],value:g[l]});return u});U(t,async()=>{if(t.value){const{url:u,element:n}=await R(t.value,!1);i.value=u,v.img=n}});const H=async()=>{const u={...v.options,minPad:d.value,bg:f.value,align:e.value,mode:s.value};if(v.options=u,!t.value&&!(v!=null&&v.img)){alert("请先选择图片");return}const n=v.splitToCvs();a.value=o.value,w.value=!0,p.value.innerHTML="",n.forEach(l=>{p.value.appendChild(l)})};return(u,n)=>(S(),T("div",Y,[h("div",K,[h("div",ee,[C(Z,{file:t.value,"onUpdate:file":n[0]||(n[0]=l=>t.value=l),content:"选择图片",width:260,height:160},null,8,["file"]),x(h("div",te,"点击图片进行下载",512),[[k,w.value]]),h("div",{ref_key:"imgsShowBox",ref:p,class:"parts-preview",style:P({"--col":a.value})},null,4)]),h("div",ie,[h("div",se,[n[3]||(n[3]=h("div",{class:"label"},"分割模式",-1)),h("div",oe,[(S(!0),T(z,null,E(N.value,l=>(S(),T("div",{class:A(["mod-option",{active:l.value===s.value}]),style:P({"--cols":l.cols}),title:l.title,onClick:_=>L(l.value,l.cols),key:l.key},[(S(!0),T(z,null,E(l.total,_=>(S(),T("div",{key:_}))),128))],14,ae))),128))])]),h("div",ne,[n[4]||(n[4]=h("div",{class:"label"},"对齐模式",-1)),h("div",le,[(S(!0),T(z,null,E(B.value,l=>(S(),T("div",{onClick:_=>e.value=l.value,class:A({active:l.value===e.value}),key:l.key},O(l.char),11,he))),128))])]),h("div",re,[h("div",ce,[n[5]||(n[5]=h("div",{class:"label"},"边距",-1)),x(h("input",{type:"number",max:"4000",min:"0","onUpdate:modelValue":n[1]||(n[1]=l=>d.value=l)},null,512),[[M,d.value]])]),h("div",de,[n[6]||(n[6]=h("div",{class:"label"},"背景颜色",-1)),x(h("input",{type:"color","onUpdate:modelValue":n[2]||(n[2]=l=>f.value=l)},null,512),[[M,f.value]])])]),h("div",{class:"start-btn-wrap"},[h("button",{onClick:H,type:"button",class:"start-btn"},"点击开始")])])])]))}},fe=JSON.parse('{"title":"图像分割","description":"","frontmatter":{"title":"图像分割","password1":"8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92","createTime":"2024-11-01T20:39:30.000Z","coverImg-":"https://s11.ax1x.com/2022/10/26/xWeR1A.png","coverText":"图像分割 | 九宫格"},"headers":[],"relativePath":"pages/tools/img-spliter.md","filePath":"pages/tools/img-spliter.md","lastUpdated":1731492822000}'),ue={name:"pages/tools/img-spliter.md"},Se=Object.assign(ue,{setup(r){return(i,t)=>(S(),T("div",{"data-pagefind-body":!0},[t[0]||(t[0]=h("h1",{id:"图像分割器",tabindex:"-1"},[$("图像分割器 "),h("a",{class:"header-anchor",href:"#图像分割器","aria-label":'Permalink to "图像分割器"'},"​")],-1)),t[1]||(t[1]=h("hr",null,null,-1)),C(y(pe))]))}});export{fe as __pageData,Se as default};
